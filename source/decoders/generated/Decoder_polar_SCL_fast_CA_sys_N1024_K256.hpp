#ifndef DECODER_POLAR_SCL_FAST_CA_SYS_N1024_K256_HPP_
#define DECODER_POLAR_SCL_FAST_CA_SYS_N1024_K256_HPP_

#include <vector>
#include <cassert>

#include "../Decoder_polar_SCL_fast_CA_sys.hpp"

namespace aff3ct
{
namespace module
{
static const std::vector<bool> Decoder_polar_SCL_fast_CA_sys_fb_1024_256 = {
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

template <class API_polar>
class Decoder_polar_SCL_fast_CA_sys_N1024_K256 : public Decoder_polar_SCL_fast_CA_sys
{
public:
	Decoder_polar_SCL_fast_CA_sys_N1024_K256(const int& K, const int& N, const int& L, CRC<int>& crc, const int n_frames = 1)
	:  Decoder_polar_SCL_fast_CA_sys(K, N, L, Decoder_polar_SCL_fast_CA_sys_fb_1024_256, crc)
	{
		const std::string name = "Decoder_polar_SCL_fast_CA_sys_N1024_K256";
		this->set_name(name);
		assert(N == 1024);
		assert(K == 268);
	}

	virtual ~Decoder_polar_SCL_fast_CA_sys_N1024_K256()
	{
	}

	void _decode(const float *Y_N)
	{

		auto  y = Y_N;
		auto &l = this->l;
		auto &s = this->s;

		API_polar::template f<512>(y, y + 512, l[0].data(), 512);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][9   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 9 -1)].data();
			API_polar::template f<256>(parent + 0, parent + 0 + 256, child + 0 + 512, 256);
		}
		this->template update_paths_rep<8, 256>(512, 0);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][9   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 9 -1)].data();
			API_polar::template gr<256>(parent + 0, parent + 0 + 256, s[path].data() + 0, child + 0 + 512, 256);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][8   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 8 -1)].data();
			API_polar::template f<128>(parent + 512, parent + 512 + 128, child + 512 + 256, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template f<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		this->template update_paths_r0<6, 64>(896, 256);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template g0<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		this->template update_paths_r0<5, 32>(960, 320);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template g0<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		this->template update_paths_r0<4, 16>(992, 352);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g0<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_r0<3, 8>(1008, 368);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g0<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_r0<2, 4>(1016, 376);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g0<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 380);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<4>(s[this->paths[i]], 376 + 4, 376, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<8>(s[this->paths[i]], 368 + 8, 368, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<16>(s[this->paths[i]], 352 + 16, 352, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<32>(s[this->paths[i]], 320 + 32, 320, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<64>(s[this->paths[i]], 256 + 64, 256, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][8   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 8 -1)].data();
			API_polar::template g<128>(parent + 512, parent + 512 + 128, s[path].data() + 256, child + 512 + 256, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template f<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		this->template update_paths_r0<5, 32>(960, 384);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template g0<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		this->template update_paths_r0<4, 16>(992, 416);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g0<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_rep<3, 8>(1008, 432);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template gr<8>(parent + 992, parent + 992 + 8, s[path].data() + 432, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 440);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 440, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 444);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 440, 440 + 4, 440, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 432, 432 + 8, 432, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<16>(s[this->paths[i]], 416 + 16, 416, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<32>(s[this->paths[i]], 384 + 32, 384, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template g<64>(parent + 768, parent + 768 + 64, s[path].data() + 384, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		this->template update_paths_rep<4, 16>(992, 448);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template gr<16>(parent + 960, parent + 960 + 16, s[path].data() + 448, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_rep<3, 8>(1008, 464);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template gr<8>(parent + 992, parent + 992 + 8, s[path].data() + 464, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 472);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 472, child + 1008 + 8, 4);
		}
		this->template update_paths_r1<2, 4>(1016, 476);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 472, 472 + 4, 472, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 464, 464 + 8, 464, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 448, 448 + 16, 448, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template g<32>(parent + 896, parent + 896 + 32, s[path].data() + 448, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_r0<2, 4>(1016, 480);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g0<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template f<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r0<1, 2>(1020, 484);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template g0<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r1<1, 2>(1020, 486);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<2>(s[this->paths[i]], 484 + 2, 484, 2);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<4>(s[this->paths[i]], 480 + 4, 480, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g<8>(parent + 992, parent + 992 + 8, s[path].data() + 480, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template f<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r0<1, 2>(1020, 488);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template g0<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r1<1, 2>(1020, 490);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<2>(s[this->paths[i]], 488 + 2, 488, 2);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 488, child + 1008 + 8, 4);
		}
		this->template update_paths_r1<2, 4>(1016, 492);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 488, 488 + 4, 488, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 480, 480 + 8, 480, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g<16>(parent + 960, parent + 960 + 16, s[path].data() + 480, child + 960 + 32, 16);
		}
		this->template update_paths_spc<4, 16>(992, 496);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 480, 480 + 16, 480, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<32>(s[this->paths[i]], 448, 448 + 32, 448, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<64>(s[this->paths[i]], 384, 384 + 64, 384, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<128>(s[this->paths[i]], 256, 256 + 128, 256, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<256>(s[this->paths[i]], 0, 0 + 256, 0, 256);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path  = this->paths[i];
			const auto child = l[this->up_ref_array_idx(path, 10 -1)].data();
			API_polar::template g<512>(y, y + 512, s[path].data() + 0, child, 512);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][9   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 9 -1)].data();
			API_polar::template f<256>(parent + 0, parent + 0 + 256, child + 0 + 512, 256);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][8   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 8 -1)].data();
			API_polar::template f<128>(parent + 512, parent + 512 + 128, child + 512 + 256, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template f<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		this->template update_paths_r0<6, 64>(896, 512);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template g0<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		this->template update_paths_r0<5, 32>(960, 576);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template g0<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		this->template update_paths_rep<4, 16>(992, 608);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template gr<16>(parent + 960, parent + 960 + 16, s[path].data() + 608, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_rep<3, 8>(1008, 624);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template gr<8>(parent + 992, parent + 992 + 8, s[path].data() + 624, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 632);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 632, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 636);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 632, 632 + 4, 632, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 624, 624 + 8, 624, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 608, 608 + 16, 608, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<32>(s[this->paths[i]], 576 + 32, 576, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<64>(s[this->paths[i]], 512 + 64, 512, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][8   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 8 -1)].data();
			API_polar::template g<128>(parent + 512, parent + 512 + 128, s[path].data() + 512, child + 512 + 256, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template f<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		this->template update_paths_rep<5, 32>(960, 640);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template gr<32>(parent + 896, parent + 896 + 32, s[path].data() + 640, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		this->template update_paths_rep<4, 16>(992, 672);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template gr<16>(parent + 960, parent + 960 + 16, s[path].data() + 672, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_rep<3, 8>(1008, 688);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template gr<8>(parent + 992, parent + 992 + 8, s[path].data() + 688, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template f<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r0<1, 2>(1020, 696);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template g0<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r1<1, 2>(1020, 698);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<2>(s[this->paths[i]], 696 + 2, 696, 2);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 696, child + 1008 + 8, 4);
		}
		this->template update_paths_r1<2, 4>(1016, 700);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 696, 696 + 4, 696, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 688, 688 + 8, 688, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 672, 672 + 16, 672, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<32>(s[this->paths[i]], 640, 640 + 32, 640, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template g<64>(parent + 768, parent + 768 + 64, s[path].data() + 640, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_r0<3, 8>(1008, 704);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g0<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_r0<2, 4>(1016, 712);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g0<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template f<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r0<1, 2>(1020, 716);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template g0<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r1<1, 2>(1020, 718);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<2>(s[this->paths[i]], 716 + 2, 716, 2);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<4>(s[this->paths[i]], 712 + 4, 712, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<8>(s[this->paths[i]], 704 + 8, 704, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g<16>(parent + 960, parent + 960 + 16, s[path].data() + 704, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_r0<2, 4>(1016, 720);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g0<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 724);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<4>(s[this->paths[i]], 720 + 4, 720, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g<8>(parent + 992, parent + 992 + 8, s[path].data() + 720, child + 992 + 16, 8);
		}
		this->template update_paths_spc<3, 8>(1008, 728);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 720, 720 + 8, 720, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 704, 704 + 16, 704, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template g<32>(parent + 896, parent + 896 + 32, s[path].data() + 704, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 736);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 736, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 740);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 736, 736 + 4, 736, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g<8>(parent + 992, parent + 992 + 8, s[path].data() + 736, child + 992 + 16, 8);
		}
		this->template update_paths_spc<3, 8>(1008, 744);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 736, 736 + 8, 736, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g<16>(parent + 960, parent + 960 + 16, s[path].data() + 736, child + 960 + 32, 16);
		}
		this->template update_paths_r1<4, 16>(992, 752);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 736, 736 + 16, 736, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<32>(s[this->paths[i]], 704, 704 + 32, 704, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<64>(s[this->paths[i]], 640, 640 + 64, 640, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<128>(s[this->paths[i]], 512, 512 + 128, 512, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][9   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 9 -1)].data();
			API_polar::template g<256>(parent + 0, parent + 0 + 256, s[path].data() + 512, child + 0 + 512, 256);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][8   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 8 -1)].data();
			API_polar::template f<128>(parent + 512, parent + 512 + 128, child + 512 + 256, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template f<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		this->template update_paths_rep<5, 32>(960, 768);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template gr<32>(parent + 896, parent + 896 + 32, s[path].data() + 768, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_r0<3, 8>(1008, 800);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g0<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_r0<2, 4>(1016, 808);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g0<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 812);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<4>(s[this->paths[i]], 808 + 4, 808, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<8>(s[this->paths[i]], 800 + 8, 800, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g<16>(parent + 960, parent + 960 + 16, s[path].data() + 800, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 816);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 816, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 820);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 816, 816 + 4, 816, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g<8>(parent + 992, parent + 992 + 8, s[path].data() + 816, child + 992 + 16, 8);
		}
		this->template update_paths_spc<3, 8>(1008, 824);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 816, 816 + 8, 816, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 800, 800 + 16, 800, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<32>(s[this->paths[i]], 768, 768 + 32, 768, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template g<64>(parent + 768, parent + 768 + 64, s[path].data() + 768, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_rep<3, 8>(1008, 832);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template gr<8>(parent + 992, parent + 992 + 8, s[path].data() + 832, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 840);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 840, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 844);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 840, 840 + 4, 840, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 832, 832 + 8, 832, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g<16>(parent + 960, parent + 960 + 16, s[path].data() + 832, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 848);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 848, child + 1008 + 8, 4);
		}
		this->template update_paths_spc<2, 4>(1016, 852);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 848, 848 + 4, 848, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g<8>(parent + 992, parent + 992 + 8, s[path].data() + 848, child + 992 + 16, 8);
		}
		this->template update_paths_r1<3, 8>(1008, 856);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 848, 848 + 8, 848, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 832, 832 + 16, 832, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template g<32>(parent + 896, parent + 896 + 32, s[path].data() + 832, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 864);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 864, child + 1008 + 8, 4);
		}
		this->template update_paths_r1<2, 4>(1016, 868);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 864, 864 + 4, 864, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g<8>(parent + 992, parent + 992 + 8, s[path].data() + 864, child + 992 + 16, 8);
		}
		this->template update_paths_r1<3, 8>(1008, 872);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 864, 864 + 8, 864, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g<16>(parent + 960, parent + 960 + 16, s[path].data() + 864, child + 960 + 32, 16);
		}
		this->template update_paths_r1<4, 16>(992, 880);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 864, 864 + 16, 864, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<32>(s[this->paths[i]], 832, 832 + 32, 832, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<64>(s[this->paths[i]], 768, 768 + 64, 768, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][8   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 8 -1)].data();
			API_polar::template g<128>(parent + 512, parent + 512 + 128, s[path].data() + 768, child + 512 + 256, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template f<64>(parent + 768, parent + 768 + 64, child + 768 + 128, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template f<32>(parent + 896, parent + 896 + 32, child + 896 + 64, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template f<16>(parent + 960, parent + 960 + 16, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		this->template update_paths_rep<3, 8>(1008, 896);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template gr<8>(parent + 992, parent + 992 + 8, s[path].data() + 896, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		this->template update_paths_rep<2, 4>(1016, 904);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template gr<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 904, child + 1008 + 8, 4);
		}
		this->template update_paths_r1<2, 4>(1016, 908);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 904, 904 + 4, 904, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 896, 896 + 8, 896, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][5   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 5 -1)].data();
			API_polar::template g<16>(parent + 960, parent + 960 + 16, s[path].data() + 896, child + 960 + 32, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template f<8>(parent + 992, parent + 992 + 8, child + 992 + 16, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template f<4>(parent + 1008, parent + 1008 + 4, child + 1008 + 8, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template f<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r0<1, 2>(1020, 912);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][2   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 2 -1)].data();
			API_polar::template g0<2>(parent + 1016, parent + 1016 + 2, child + 1016 + 4, 2);
		}
		this->template update_paths_r1<1, 2>(1020, 914);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo0<2>(s[this->paths[i]], 912 + 2, 912, 2);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][3   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 3 -1)].data();
			API_polar::template g<4>(parent + 1008, parent + 1008 + 4, s[path].data() + 912, child + 1008 + 8, 4);
		}
		this->template update_paths_r1<2, 4>(1016, 916);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<4>(s[this->paths[i]], 912, 912 + 4, 912, 4);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][4   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 4 -1)].data();
			API_polar::template g<8>(parent + 992, parent + 992 + 8, s[path].data() + 912, child + 992 + 16, 8);
		}
		this->template update_paths_r1<3, 8>(1008, 920);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<8>(s[this->paths[i]], 912, 912 + 8, 912, 8);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<16>(s[this->paths[i]], 896, 896 + 16, 896, 16);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][6   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 6 -1)].data();
			API_polar::template g<32>(parent + 896, parent + 896 + 32, s[path].data() + 896, child + 896 + 64, 32);
		}
		this->template update_paths_spc<5, 32>(960, 928);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<32>(s[this->paths[i]], 896, 896 + 32, 896, 32);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			const auto path   = this->paths[i];
			const auto parent = l[this->path_2_array    [path][7   ]].data();
			const auto child  = l[this->up_ref_array_idx(path, 7 -1)].data();
			API_polar::template g<64>(parent + 768, parent + 768 + 64, s[path].data() + 896, child + 768 + 128, 64);
		}
		this->template update_paths_spc<6, 64>(896, 960);
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<64>(s[this->paths[i]], 896, 896 + 64, 896, 64);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<128>(s[this->paths[i]], 768, 768 + 128, 768, 128);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<256>(s[this->paths[i]], 512, 512 + 256, 512, 256);
		}
		for (auto i = 0; i < this->n_active_paths; i++) 
		{
			API_polar::template xo<512>(s[this->paths[i]], 0, 0 + 512, 0, 512);
		}
	}
};
}
}
#endif
